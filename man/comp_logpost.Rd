% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_logpost.R
\name{comp_logpost}
\alias{comp_logpost}
\title{Compute Log Posterior for Cluster Sequence Model}
\usage{
comp_logpost(alpha, w, lambda, model_data, z = NULL, fixed_sd)
}
\arguments{
\item{alpha}{Matrix. Regression/basis coefficients for all clusters (dimension: (n_basis x M) by G).}

\item{w}{Integer vector. Current secondary clustering assignments for all subjects/observations.}

\item{lambda}{Numeric matrix. Regularization hyperparameters for penalized coefficients (typically dimension: M by (G-1)).}

\item{model_data}{A model_data object generated by create_model_data, containing basis, cluster/group, and penalty structure.}

\item{fixed_sd}{Numeric. The standard deviation for unpenalized parameters (default: typically 10 in workflow).}
}
\value{
A numeric scalar. The total log posterior value: sum of the log-likelihood and all log prior densities for penalized and non-penalized coefficients.
}
\description{
Internal: Compute the log posterior (log-likelihood plus log-prior penalties) for a given set of regression parameters, cluster assignments, and penalty hyperparameters in the cluster sequence model. Used internally during MCMC sampling to evaluate model fit and penalization at each step.
}
\details{
Computes the log-likelihood as the sum of log-probabilities for observed categories under the current parameterization. Applies penalty terms to the coefficients: coefficients in the penalized set use a variance that depends on lambda and the penalty matrix, while non-penalized coefficients use a fixed variance (fixed_sd). All log-density penalties are computed with the normal distribution (stats::dnorm). Uses predicted probabilities from the helper predict_cat (type = "category probability") for likelihood calculation. Intended for internal use.
}
\keyword{internal}
