% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/update_lambda.R
\name{update_lambda}
\alias{update_lambda}
\title{Update Lambda Parameters}
\usage{
update_lambda(
  alpha,
  a = 1,
  b = 1,
  model_data,
  grouped_lambda = FALSE,
  CUST = FALSE
)
}
\arguments{
\item{alpha}{Numeric matrix of current alpha coefficients (basis coefficients), with rows corresponding to basis functions and columns to groups/classes.}

\item{a}{Numeric. Shape parameter for the Gamma prior (default: 1).}

\item{b}{Numeric. Rate parameter for the Gamma prior (default: 1).}

\item{model_data}{List. Model data structure (from create_model_data), must include G, M, n_basis, notpen_index, and other relevant fields.}

\item{grouped_lambda}{Logical. If TRUE, use grouped lambda update (default: FALSE).}

\item{CUST}{Logical. Custom mode (default: FALSE).}
}
\value{
Matrix of updated lambda values with dimensions M (groups) by G-1 (classes).
}
\description{
Internal: Update the lambda (penalty) parameters for each group and class using a Gamma or inverse-Gamma prior, based on the current values of the alpha coefficients.
}
\details{
For each class (except the last), this function aggregates the squared alpha coefficients (excluding non-penalized indices) by group, and samples new lambda values from the (inverse-)Gamma posterior. The update is performed for each group and class. If grouped_lambda is TRUE, a grouped update is performed. For penalized splines (basis_type == "ps"), a different update is used based on the S matrix.
}
\keyword{internal}
