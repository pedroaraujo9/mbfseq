% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/update_z.R
\name{update_z}
\alias{update_z}
\title{Update Primary Cluster Assignments (z)}
\usage{
update_z(mu, sigma, w = NULL, alpha = NULL, model_data)
}
\arguments{
\item{mu}{Numeric matrix of cluster means (G x number of variables).}

\item{sigma}{Numeric vector of cluster standard deviations (length G).}

\item{w}{Optional integer vector of secondary cluster assignments (default NULL).}

\item{alpha}{Optional numeric matrix of coefficients for the sequence model (default NULL).}

\item{model_data}{List containing model data including \code{x}, \code{G}, \code{n_vars}, \code{id_time_df}.}
}
\value{
A list with:
\describe{
\item{z}{Integer vector of sampled primary cluster assignments.}
\item{z_post_prob}{Matrix of posterior probabilities for each observation belonging to each primary cluster.}
}
}
\description{
Internal: Update the primary cluster assignments (\code{z}) for each observation
using Gibbs sampling based on the current parameters of the observation
model (mu and sigma) and optionally the sequence model (w and alpha).
}
\keyword{internal}
