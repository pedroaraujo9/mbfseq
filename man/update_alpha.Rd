% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/update_alpha.R
\name{update_alpha}
\alias{update_alpha}
\title{Update Alpha Coefficient Matrix}
\usage{
update_alpha(alpha, lambda, z, w, model_data, fixed_sd = 10, intercept = FALSE)
}
\arguments{
\item{alpha}{Matrix. Current values of the alpha coefficients (basis × groups).}

\item{lambda}{Regularization or penalty hyperparameter(s) for the prior or penalty (format as required by gen_inv_cov).}

\item{z}{Integer vector. Primary cluster assignment for each subject or observation.}

\item{w}{Integer vector. Secondary cluster assignment for each subject or observation.}

\item{model_data}{List. Model data structure (from create_model_data), must include all required matrices, indices, and group counts.}

\item{fixed_sd}{Numeric. Fixed standard deviation for the prior or penalty in the update step (default: 10).}

\item{intercept}{Logical. Whether to include an intercept in the model (default: FALSE).}
}
\value{
Updated matrix of alpha coefficients (basis × groups).
}
\description{
Internal: Update the matrix of coefficients (alpha) for the clustering model using current assignments and regularization/penalization parameters. Used in the MCMC or EM loop to sample or optimize new alpha values for each group.
}
\details{
This function cycles through G-1 groups (leaving one as baseline/reference), updating coefficients for each group. It constructs dummy matrices for group assignments (Z and W), forms the block design matrix via kronecker product, and calls internal helpers (gen_inv_cov, gen_dummy, augment_alpha) to perform the update. The update is typically used within a Gibbs sampler or EM algorithm for mixture or clustering models with basis expansions.
}
\seealso{
clustseq_single_run, create_model_data
}
\keyword{internal}
