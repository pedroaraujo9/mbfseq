% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibrate_lambda.R
\name{calibrate_lambda}
\alias{calibrate_lambda}
\title{Calibrate Lambda for Penalization via Bayesian or Grid Search}
\usage{
calibrate_lambda(
  bounds = c(0.01, 10),
  model_data,
  fixed_sd = 10,
  method = "bayes",
  options = list(init_points = 5, iters_n = 10, acq = "ucb", kappa = 2.57, length_out =
    20)
)
}
\arguments{
\item{bounds}{Numeric vector of length 2. Range of lambda to explore (default: c(0.01, 10)).}

\item{model_data}{A model_data object as returned by create_model_data, with basis, clustering, and index fields.}

\item{fixed_sd}{Numeric. Fixed standard deviation for priors/penalties in the Stan model (default: 10).}

\item{method}{Character. "bayes" for Bayesian optimization via the ParBayesianOptimization package, or "grid" for a regular grid search.}

\item{options}{List. Options passed to the optimizer.
For the "bayes" method:
- init_points: Number of random initialization points (default: 5)
- iters_n: Number of Bayesian optimization iterations (default: 10)
- acq: Acquisition function (default: "ucb")
- kappa: Exploration factor for the acquisition function (default: 2.57)
For the "grid" method:
- length_out: Number of grid points (default: 20)}
}
\value{
A list with the following elements:
\describe{
\item{fit}{The object returned by the optimizer (a bayesOpt object for the "bayes" method, or a data.frame for the "grid" method).}
\item{best_lambda}{The optimal value of lambda found.}
\item{lambda_plot}{(Grid method only) ggplot2 object for visualizing penalized likelihood versus lambda.}
}
}
\description{
Internal: Optimize the penalty hyperparameter lambda for your cluster sequence model by either Bayesian optimization or grid search, using held-out likelihood as the objective.
}
\details{
Loads and reuses a Stan model template from the package's extdata folder. Uses find_map to evaluate the penalized likelihood for each value of lambda. Bayesian optimization is powered by the ParBayesianOptimization package. For grid search, the output includes a plot of penalized score versus lambda (see lambda_plot). Intended for internal use.
}
\keyword{internal}
