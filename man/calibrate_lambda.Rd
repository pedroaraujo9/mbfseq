% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibrate_lambda.R
\name{calibrate_lambda}
\alias{calibrate_lambda}
\title{Calibrate Lambda for Penalization via Grid Search}
\usage{
calibrate_lambda(
  z = NULL,
  w = NULL,
  model_data,
  config = list(bounds = c(0.01, 10), n_points = 20, n_start_iters = 20, lambda_start =
    1, epsilon_w = 1, beta_sd = sqrt(10), mu_sd = sqrt(10), sigma_a = 1, sigma_b = 1)
)
}
\arguments{
\item{z}{Optional. Sequence vector for clustering initialization. If NULL, will use find_init to generate initial z and w.}

\item{w}{Optional. Cluster assignments for initialization. If NULL, will be computed from z or find_init.}

\item{model_data}{A model_data object as returned by create_model_data, with basis, clustering, and index fields.}

\item{config}{List of configuration options:
\describe{
\item{bounds}{Numeric vector of length 2. Range of lambda to explore (default: c(0.01, 10)).}
\item{n_points}{Number of grid points (default: 20).}
\item{n_start_iters}{Number of initialization iterations for find_init (default: 20).}
\item{lambda_start}{Initial lambda value for find_init (default: 1).}
\item{epsilon_w}{Unused in this function, passed to find_init.}
\item{beta_sd}{Fixed standard deviation for priors/penalties in the Stan model (default: sqrt(10)).}
\item{mu_sd}{Unused in this function, passed to find_init.}
\item{sigma_a}{Unused in this function, passed to find_init.}
\item{sigma_b}{Unused in this function, passed to find_init.}
}}
}
\value{
A list with the following elements:
\describe{
\item{fit}{A data.frame with lambda values and penalized log-likelihood scores.}
\item{best_lambda}{The optimal value of lambda found.}
\item{w}{Cluster assignments used for optimization.}
\item{z}{Sequence vector used for optimization.}
\item{lambda_plot}{ggplot2 object for visualizing penalized likelihood versus lambda.}
}
}
\description{
Internal: Optimize the penalty hyperparameter lambda for your cluster sequence model by grid search, using held-out likelihood as the objective.
}
\details{
Loads and reuses a Stan model template from the package's extdata folder. Uses find_map to evaluate the penalized likelihood for each value of lambda. Intended for internal use.
}
\keyword{internal}
