% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/update_sigma.R
\name{update_sigma}
\alias{update_sigma}
\title{Update Cluster Standard Deviations}
\usage{
update_sigma(mu, z, sigma_a = 1, sigma_b = 1, model_data)
}
\arguments{
\item{mu}{Matrix of cluster means (G x n_vars).}

\item{z}{Vector of cluster assignments for each observation (length n).}

\item{sigma_a}{Numeric. Shape parameter for the inverse gamma prior on sigma^2 (default 1).}

\item{sigma_b}{Numeric. Rate parameter for the inverse gamma prior on sigma^2 (default 1).}

\item{model_data}{List. Model data structure including \code{x} (observation matrix), \code{G} (number of clusters), and \code{n_vars} (number of variables).}
}
\value{
Numeric vector of updated cluster standard deviations (length G).
}
\description{
Internal: Update the cluster standard deviations (\code{sigma}) using Gibbs sampling.
}
\details{
For each cluster g, this function computes the sum of squared errors (SSE)
between the observations assigned to that cluster and the cluster's current
mean. This SSE is used along with the prior parameters (\code{sigma_a} and \code{sigma_b})
to define the parameters of the inverse-gamma posterior distribution for the
variance (sigma^2) of that cluster. A new variance is sampled from this posterior,
and the standard deviation (\code{sigma}) is obtained by taking the square root of
the sampled variance.
}
\keyword{internal}
