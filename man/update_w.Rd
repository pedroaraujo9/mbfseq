% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/update_w.R
\name{update_w}
\alias{update_w}
\title{Update Latent Cluster Memberships}
\usage{
update_w(alpha, pw, z, model_data, intercept = FALSE, mean_effect = FALSE)
}
\arguments{
\item{alpha}{Matrix. Current group-specific coefficient matrix (columns = groups).}

\item{pw}{Numeric vector. Prior cluster membership probabilities for each cluster.}

\item{z}{Integer vector. Observed cluster labels for each observation.}

\item{model_data}{List. Model data structure (from create_model_data), must include M, n_id, id_unique, w_logp_base.}

\item{intercept}{Logical. Include intercept in model? Default is FALSE.}

\item{mean_effect}{Logical. Use mean effect? Default is FALSE.}
}
\value{
A list with:
\describe{
\item{w}{Integer vector of sampled cluster assignments.}
\item{w_post_prob}{Matrix of posterior cluster probabilities.}
\item{marg_log_like}{Vector of marginal log-likelihood values for each individual.}
}
}
\description{
Internal: Sample updated latent cluster assignments for each individual based on posterior probabilities, given current model parameters and observed data.
}
\details{
For each individual, this function computes the posterior distribution over latent cluster indicators using the current model parameters. It:
\itemize{
\item Computes the log-probability of the observed data for each possible cluster assignment.
\item Adds the log prior for each cluster.
\item Normalizes to obtain posterior probabilities (in log space for stability).
\item Samples new cluster assignments from the posterior using categorical sampling.
\item Returns the sampled assignments, the posterior probability matrix, and the marginal log-likelihood for each individual.
}
}
\keyword{internal}
