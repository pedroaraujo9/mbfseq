% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/update_pw.R
\name{update_pw}
\alias{update_pw}
\title{Update Cluster Membership Probabilities}
\usage{
update_pw(w, epsilon = 1, model_data)
}
\arguments{
\item{w}{Integer vector of latent cluster memberships (values from 1 to M).}

\item{epsilon}{Numeric. Value added to Dirichlet concentration parameters (default 1).}

\item{model_data}{List. Model data structure, must include number of clusters M.}
}
\value{
Numeric vector of updated cluster probabilities (length M).
}
\description{
Internal: Update the latent cluster membership probabilities (pw) using a Dirichlet posterior, based on current cluster allocations.
}
\details{
This function computes the posterior Dirichlet parameters for the cluster membership probabilities by counting the number of assignments to each cluster (from w), adding epsilon for smoothing, and sampling from the resulting Dirichlet distribution. Probabilities smaller than 1e-300 are thresholded for numerical stability.
}
\keyword{internal}
